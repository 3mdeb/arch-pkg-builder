Arch pkg builder
=================

### Usage

* Build container:

  ```
  docker build -t 3mdeb/arch-pkg-builder
  ```

* Place [arch pkg scripts](https://wiki.archlinux.org/index.php/Kernels/Arch_Build_System)
  within `pkg` directory. It will be mounted inside container.

* Run container to automatically build package:

  ```
  ./arch-pkg-builder.sh
  ```

It was tested with recent kernel packages so far (4.12)

### Known issues

Sometimes when building `logankoester/archlinux`:

  ``` Sending build context to Docker daemon  4.608kB Step 1/7 : FROM
logankoester/archlinux # Executing 1 build trigger...  Step 1/1 : RUN
pacman-key --populate &&   pacman-key --refresh-keys &&   pacman -Sy
    --noprogressbar --noconfirm &&   pacman -S --force openssl --noconfirm &&
    pacman -S pacman --noprogressbar --noconfirm &&   pacman-db-upgrade &&
    pacman -Syyu --noprogressbar --noconfirm
   ---> Running in 4d552992b194
  ==> Appending keys from archlinux.gpg...
  ==> Locally signing trusted keys in keyring...
    -> Locally signing key 684148BB25B49E986A4944C55184252D824B18E8...
    -> Locally signing key 91FFE0700E80619CEB73235CA88E23E377514E00...
    -> Locally signing key AB19265E5D7D20687D303246BA1DFB64FFF979E7...
    -> Locally signing key 0E8B644079F599DFC1DDC3973348882F6AC6A4C2...
    -> Locally signing key 44D4A033AC140143927397D47EFD567D4C7EA887...
  ==> Importing owner trust values...
  ==> Disabling revoked keys in keyring...
    -> Disabling key 7FA647CD89891DEDC060287BB9113D1ED21E1A55...
    -> Disabling key D4DE5ABDE2A7287644EAC7E36D1A9E70E19DAA50...
    -> Disabling key 40440DC037C05620984379A6761FAD69BA06C6A9...
    -> Disabling key BC1FBE4D2826A0B51E47ED62E2539214C6C11350...
    -> Disabling key 63F395DE2D6398BBE458F281F2DBB4931985A992...
    -> Disabling key 8F76BEEA0289F9E1D3E229C05F946DED983D4366...
    -> Disabling key 81D7F8241DB38BC759C80FCE3A726C6170E80477...
    -> Disabling key 5E7585ADFF106BFFBBA319DC654B877A0864983E...
    -> Disabling key E7210A59715F6940CF9A4E36A001876699AD6E84...
    -> Disabling key F5A361A3A13554B85E57DDDAAF7EF7873CFD4BB6...
    -> Disabling key 9515D8A8EAB88E49BB65EDBCE6B456CAF15447D5...
    -> Disabling key 4A8B17E20B88ACA61860009B5CED81B7C2E5C0D2...
    -> Disabling key 0B20CA1931F5DA3A70D0F8D2EA6836E1AB441196...
    -> Disabling key 66BD74A036D522F51DD70A3C7F2A16726521E06D...
    -> Disabling key 27FFC4769E19F096D41D9265A04F9397CDFD6BB0...
  ==> Updating trust database...
  gpg: next trustdb check due at 2017-09-07
  gpg: refreshing 91 keys from hkp://pool.sks-keyservers.net
  gpg: keyserver refresh failed: Cannot assign requested address
  ==> ERROR: A specified local key could not be updated from a keyserver.
  ```

I was not able to identify cause of this error. Some
[similar issue](https://github.com/guywithnose/docker-solr/issues/1) suggests
it may be related to updating all keys at once.
